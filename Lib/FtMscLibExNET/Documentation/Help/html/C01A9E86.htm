<html><head><link rel="shortcut icon" href="../icons/favicon.ico" /><style type="text/css">.OH_CodeSnippetContainerTabLeftActive, .OH_CodeSnippetContainerTabLeft,.OH_CodeSnippetContainerTabLeftDisabled { }.OH_CodeSnippetContainerTabRightActive, .OH_CodeSnippetContainerTabRight,.OH_CodeSnippetContainerTabRightDisabled { }.OH_footer { }</style><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>FtMscLibEx.OnInputChanged Event</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="OnInputChanged event" /><meta name="System.Keywords" content="FtMscLibEx.OnInputChanged event" /><meta name="Microsoft.Help.F1" content="FischerTechnik.FtMscLib.API.FtMscLibEx.OnInputChanged" /><meta name="Microsoft.Help.Id" content="E:FischerTechnik.FtMscLib.API.FtMscLibEx.OnInputChanged" /><meta name="Description" content="Notification that a Universal Input has been changed" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="'true'" /><meta name="container" content="FischerTechnik.FtMscLib.API" /><meta name="file" content="C01A9E86" /><meta name="guid" content="C01A9E86" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"></script><meta name="SelfBranded" content="true" /></head><body onload="onLoad()"><div class="OH_outerDiv"><div class="OH_outerContent"><table class="TitleTable"><tr><td class="OH_tdTitleColumn">FtMscLibEx<span id="ID0EBBABABAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBBABABAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>OnInputChanged Event</td><td class="OH_tdRunningTitleColumn">FtMscLibExNet for .NET framework 4</td></tr></table><div id="mainSection"><div id="mainBody"><span class="introStyle">Support for fischertechnik TX-controller</span><p style="color: #dc143c; font-size: 8.5pt; font-weight: bold;">[This is preliminary documentation and is subject to change.]</p><div class="summary">
 Notification that a Universal Input has been changed
 </div><p></p><strong>Namespace:</strong> <a href="49D92C23.htm">FischerTechnik.FtMscLib.API</a><br /><strong>Assembly:</strong> FtMscLibVBNet (in FtMscLibVBNet.dll) Version: 1.0.0.1 (1.0.0.10)<div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Syntax</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><div id="snippetGroup_Syntax" class="code"><div id="ID0ECDEAAABAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0ECDEAAABAA_tabs"><div class="OH_CodeSnippetContainerTabLeftActive" id="ID0ECDEAAABAA_tabimgleft"></div><div id="ID0ECDEAAABAA_tab1" class="OH_CodeSnippetContainerTabActive" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0ECDEAAABAA','C#','1','4');return false;">C#</a></div><div id="ID0ECDEAAABAA_tab2" class="OH_CodeSnippetContainerTab" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0ECDEAAABAA','Visual Basic','2','4');return false;">VB</a></div><div id="ID0ECDEAAABAA_tab3" class="OH_CodeSnippetContainerTab" EnableCopyCode="true"><a href="#" onclick="javascript:ChangeTab('ID0ECDEAAABAA','Visual C++','3','4');return false;">C++</a></div><div id="ID0ECDEAAABAA_tab4" class="OH_CodeSnippetContainerTabDisabledNotFirst" EnableCopyCode="true" disabled="true"><a>F#</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0ECDEAAABAA_tabimgright"></div></div><div id="ID0ECDEAAABAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0ECDEAAABAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0ECDEAAABAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0ECDEAAABAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0ECDEAAABAA','4')" title="Print">Print</a></div></div><div id="ID0ECDEAAABAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre><span class="keyword">public</span> event <span class="identifier">FtMscLibEx<span id="IDLST000001">&amp;#160;</span><script type="text/javascript">addToLanSpecTextIdSet("IDLST000001?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>OnInputChangedEventHandler</span> <span class="identifier">OnInputChanged</span></pre></div><div id="ID0ECDEAAABAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>public event FtMscLibEx..::..OnInputChangedEventHandler OnInputChanged</pre></div><div id="ID0ECDEAAABAA_code_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre><span class="keyword">Public</span> Event <span class="identifier">OnInputChanged</span> <span class="keyword">As</span> <span class="identifier">FtMscLibEx<span id="IDLST000002">&amp;#160;</span><script type="text/javascript">addToLanSpecTextIdSet("IDLST000002?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>OnInputChangedEventHandler</span></pre></div><div id="ID0ECDEAAABAA_code_Plain_Div2" class="OH_CodeSnippetContainerCode" style="display: none"><pre>Public Event OnInputChanged As FtMscLibEx..::..OnInputChangedEventHandler</pre></div><div id="ID0ECDEAAABAA_code_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre><span class="keyword">public</span>:
 <span class="keyword">event</span> <span class="identifier">FtMscLibEx<span id="IDLST000003">&amp;#160;</span><script type="text/javascript">addToLanSpecTextIdSet("IDLST000003?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>OnInputChangedEventHandler</span>^ <span class="identifier">OnInputChanged</span> {
	<span class="keyword">void</span> <span class="keyword">add</span> (<span class="identifier">FtMscLibEx<span id="IDLST000004">&amp;#160;</span><script type="text/javascript">addToLanSpecTextIdSet("IDLST000004?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>OnInputChangedEventHandler</span>^ <span class="parameter">value</span>);
	<span class="keyword">void</span> <span class="keyword">remove</span> (<span class="identifier">FtMscLibEx<span id="IDLST000005">&amp;#160;</span><script type="text/javascript">addToLanSpecTextIdSet("IDLST000005?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>OnInputChangedEventHandler</span>^ <span class="parameter">value</span>);
}</pre></div><div id="ID0ECDEAAABAA_code_Plain_Div3" class="OH_CodeSnippetContainerCode" style="display: none"><pre>public:
 event FtMscLibEx..::..OnInputChangedEventHandler^ OnInputChanged {
	void add (FtMscLibEx..::..OnInputChangedEventHandler^ value);
	void remove (FtMscLibEx..::..OnInputChangedEventHandler^ value);
}</pre></div><div id="ID0ECDEAAABAA_code_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div><div id="ID0ECDEAAABAA_code_Plain_Div4" class="OH_CodeSnippetContainerCode" style="display: none"><pre /></div></div></div><script>addSpecificTextLanguageTagSet('ID0ECDEAAABAA');</script></div><h4 class="subHeading">Value</h4>Type: <a href="A2796303.htm">FischerTechnik.FtMscLib.API<span id="ID0EDAEAAABAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EDAEAAABAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>FtMscLibEx<span id="ID0EBAEAAABAA"> </span><script type="text/javascript">
					addToLanSpecTextIdSet("ID0EBAEAAABAA?vb=.|cpp=::|cs=.|fs=.|nu=.");
				</script>OnInputChangedEventHandler</a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Remarks</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div>The Input must has been Enabled!<br /><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">Examples</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><div id="ID0EACAAABAA" class="OH_CodeSnippetContainer"><div class="OH_CodeSnippetContainerTabs" id="ID0EACAAABAA_tabs"><div class="OH_CodeSnippetContainerTabLeft" id="ID0EACAAABAA_tabimgleft"></div><div id="ID0EACAAABAA_tab1" class="OH_CodeSnippetContainerTabSolo" EnableCopyCode="true"><a xmlns="">Universal Input event</a></div><div class="OH_CodeSnippetContainerTabRight" id="ID0EACAAABAA_tabimgright"></div></div><div id="ID0EACAAABAA_codecollection" class="OH_CodeSnippetContainerCodeCollection"><div class="OH_CodeSnippetToolBar"><div class="OH_CodeSnippetToolBarText"><a id="ID0EACAAABAA_copycode" href="#" onclick="javascript:CopyToClipboard('ID0EACAAABAA','4')" title="Copy to Clipboard">Copy to Clipboard</a><a id="ID0EACAAABAA_PrintText" class="OH_PrintText" href="#" onclick="javascript:Print('ID0EACAAABAA','4')" title="Print">Print</a></div></div><div id="ID0EACAAABAA_code_Div1" class="OH_CodeSnippetContainerCode" style="display: block"><pre>       <span class="highlight-comment">'Initalize the I1  as digital inputs passive</span>
       errCode = myController.SetFtUniConfig(devId:=FtDeviceID.Master, ioId:=FtInput.I1, _
                                    mode:=FtInputMode.Resistance, digital:=<span class="highlight-keyword">True</span>)
       <span class="highlight-comment">'Install eventhandler</span> 
       <span class="highlight-keyword">AddHandler</span> myController.OnInputChanged, <span class="highlight-keyword">AddressOf</span> <span class="highlight-keyword">Me</span>.MyInput2_Changed
       <span class="highlight-comment">'Events mask: Activate the I1  event</span>
       errCode = myController.EnableCBMaskUniChanged(devId:=FtDeviceID.Master, inputIndex:=FtInput.I1, enable:=<span class="highlight-keyword">True</span>)

   <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> MyInput2_Changed(<span class="highlight-keyword">ByVal</span> sender <span class="highlight-keyword">As</span> <span class="highlight-keyword">Object</span>, args <span class="highlight-keyword">As</span> InputChangedEventArgs)
   <span class="highlight-keyword">Dim</span> result <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = <span class="highlight-literal">"MyInput2_Changed event dev="</span> + args.devId.ToString() + _
                        <span class="highlight-literal">" ioId="</span> + args.ioId.ToString() + _
                        <span class="highlight-literal">" value="</span> + args.value.ToString() + <span class="highlight-literal">"  dig/ana="</span> + args.digital.ToString()
    <span class="highlight-comment">'Need to invoke because of the TextBox is running in a different thread!!</span> 
    <span class="highlight-keyword">Me</span>.Invoke((<span class="highlight-keyword">Sub</span>(t <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>) <span class="highlight-keyword">Me</span>.txtInfo.AppendText(t)), <span class="highlight-literal">"Invoke: "</span> + result + vbCrLf)
    <span class="highlight-keyword">If</span> ((args.devId = FtDeviceID.Master) <span class="highlight-keyword">And</span> (args.ioId = FtInput.I1)) <span class="highlight-keyword">Then</span> 
      <span class="highlight-keyword">If</span> (args.value = <span class="highlight-number">1</span>) <span class="highlight-keyword">Then</span>
          myController.SetOutPwmValues(devId:=FtDeviceID.Master, outId:=FtOutput.O4, duty:=<span class="highlight-number">512</span>)
      <span class="highlight-keyword">Else</span>
         myController.SetOutPwmValues(devId:=<span class="highlight-number">0</span>, outId:=FtOutput.O4, duty:=<span class="highlight-number">0</span>)
     <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span> 
   <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span> 
   <span class="highlight-keyword">If</span> ((args.devId = FtDeviceID.Master) <span class="highlight-keyword">And</span> (args.ioId = FtInput.I2)) <span class="highlight-keyword">Then</span> 
    <span class="highlight-keyword">If</span> (args.value = <span class="highlight-number">1</span>) <span class="highlight-keyword">Then</span>
        myController.SetOutPwmValues(devId:=FtDeviceID.Master, outId:=FtOutput.O5, duty:=<span class="highlight-number">512</span>)
    <span class="highlight-keyword">Else</span>
       myController.SetOutPwmValues(devId:=FtDeviceID.Master, outId:=FtOutput.O5, duty:=<span class="highlight-number">0</span>)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span> 
  <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span> 
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div><div id="ID0EACAAABAA_code_Plain_Div1" class="OH_CodeSnippetContainerCode" style="display: none"><pre>       'Initalize the I1  as digital inputs passive
       errCode = myController.SetFtUniConfig(devId:=FtDeviceID.Master, ioId:=FtInput.I1, _
                                    mode:=FtInputMode.Resistance, digital:=True)
       'Install eventhandler 
       AddHandler myController.OnInputChanged, AddressOf Me.MyInput2_Changed
       'Events mask: Activate the I1  event
       errCode = myController.EnableCBMaskUniChanged(devId:=FtDeviceID.Master, inputIndex:=FtInput.I1, enable:=True)

   Public Sub MyInput2_Changed(ByVal sender As Object, args As InputChangedEventArgs)
   Dim result As String = "MyInput2_Changed event dev=" + args.devId.ToString() + _
                        " ioId=" + args.ioId.ToString() + _
                        " value=" + args.value.ToString() + "  dig/ana=" + args.digital.ToString()
    'Need to invoke because of the TextBox is running in a different thread!! 
    Me.Invoke((Sub(t As String) Me.txtInfo.AppendText(t)), "Invoke: " + result + vbCrLf)
    If ((args.devId = FtDeviceID.Master) And (args.ioId = FtInput.I1)) Then 
      If (args.value = 1) Then
          myController.SetOutPwmValues(devId:=FtDeviceID.Master, outId:=FtOutput.O4, duty:=512)
      Else
         myController.SetOutPwmValues(devId:=0, outId:=FtOutput.O4, duty:=0)
     End If 
   End If 
   If ((args.devId = FtDeviceID.Master) And (args.ioId = FtInput.I2)) Then 
    If (args.value = 1) Then
        myController.SetOutPwmValues(devId:=FtDeviceID.Master, outId:=FtOutput.O5, duty:=512)
    Else
       myController.SetOutPwmValues(devId:=FtDeviceID.Master, outId:=FtOutput.O5, duty:=0)
    End If 
  End If 
End Sub</pre></div></div></div><script>addSpecificTextLanguageTagSet('ID0EACAAABAA');</script><a name="seeAlsoSection"></a><div class="OH_CollapsibleAreaRegion"><div class="OH_regiontitle">See Also</div><div class="OH_CollapsibleArea_HrDiv"><hr class="OH_CollapsibleArea_Hr" /></div></div><div class="OH_clear"></div><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="61AC1628.htm">FtMscLibEx Class</a></div><div class="seeAlsoStyle"><a href="49D92C23.htm">FischerTechnik.FtMscLib.API Namespace</a></div><h4 class="subHeading">Other Resources</h4><div class="seeAlsoStyle"><a href="http://www.codeproject.com/Articles/5041/Step-by-Step-Event-handling-in-VB-NET" target="_blank">http://www.codeproject.com/Articles/5041/Step-by-Step-Event-handling-in-VB-NET</a></div></div></div></div></div><div id="OH_footer" class="OH_footer">include native sensor events<p><a href="http://web.inter.nl.net/users/Ussel-IntDev/" target="_blank">© 2014 Ussel-Educ for Fischertechnik GmbH</a></p><div class="OH_feedbacklink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:ft.info%40inter.nl.net?Subject=FtMscLibExNet for .NET framework 4">E-mail use about your experciances with this help.</a></div><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>